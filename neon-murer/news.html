<!DOCTYPE html>
<html lang="de" id="www-neonmurer-ch">
<head>
  <!-- CDN Preloads für bessere Performance -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="preconnect" href="https://code.jquery.com" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>News & Aktuelles - Neon Murer AG</title>
  <link rel="stylesheet" type="text/css" href="../template/inc_css/include.css">
  
  <!-- Font Awesome CDN für Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" crossorigin="anonymous">
  
<link rel="icon" type="image/png" href="../favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="../favicon/favicon.svg" />
  <link rel="shortcut icon" href="../favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Neon Murer" />
  <link rel="manifest" href="../favicon/site.webmanifest" />
  
  <!--[if lt IE 9]><script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script><![endif]-->
  <!--[if gte IE 9]><!--><script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script><!--<![endif]-->
  
  <meta name="description" content="Aktuelle News und Informationen von Neon Murer AG - Erfahren Sie Neuigkeiten aus der Werbetechnik, Projekte und Unternehmensgeschehen.">
  <meta name="keywords" content="News, Aktuelles, Werbetechnik, Neon Murer, Projekte, Unternehmen, Neuigkeiten, Schweiz">
  <link rel="canonical" href="https://www.neonmurer.ch/neon-murer/news.html">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="../template/assets/js/slick.min.js"></script>
  
  <script src="../template/assets/js/custom.js"></script>

  <!-- ========== TEMPLATE SYSTEM ========== -->
  <script src="../template/assets/js/templates.js"></script>
  <script src="../template/assets/js/simple-template-loader.js"></script>  
  <!-- Usage Statistics -->
  <script src="../template/assets/js/neon-usage-stats.js"></script>
  
  <!-- Privacy Manager -->
  <script src="../template/assets/js/neon-privacy-manager.js"></script>

  <!-- Page Specific CSS -->
  <link rel="stylesheet" href="../template/assets/css/news.css">


</head>

<body class="custom">
<!-- ========== HEADER PLACEHOLDER ========== -->
<div id="header-placeholder">
  <!-- Header wird automatisch vom Template Loader geladen -->
  <div class="text-center py-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Header wird geladen...</span>
    </div>
  </div>
</div>

<main>
  <!-- Hero Section -->
  <section class="news-hero">
    <div class="container-fluid maxwidth">
      <div class="hero-content">
        <h1 class="hero-title">News & Aktuelles</h1>
        <p class="hero-subtitle">Bleiben Sie auf dem Laufenden</p>
        <p class="hero-description">
          Erfahren Sie Neuigkeiten aus unserem Unternehmen, aktuelle Projekte und 
          Entwicklungen in der Werbetechnik-Branche. Hier finden Sie alle wichtigen 
          Informationen rund um Neon Murer AG.
        </p>
      </div>
    </div>
  </section>

  <!-- News Section -->
  <section class="news-section">
    <div class="container-fluid maxwidth">
      <div class="section-header">
        <h2 class="section-title">Aktuelle Meldungen</h2>
        <p class="section-subtitle">
          Die neuesten Nachrichten und Projekte aus unserem Unternehmen
        </p>
      </div>

      <!-- News Grid -->
      <div class="news-grid" id="news-grid">
        <!-- News werden hier dynamisch geladen -->
        <div class="loading-spinner">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">News werden geladen...</span>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- News Modals -->

<!-- Dynamisches News Modal -->
<div id="news-modal" class="news-modal">
  <div class="modal-content">
    <div class="modal-header">
      <button class="modal-close" onclick="closeNewsModal()">&times;</button>
      <h2 class="modal-news-title" id="modal-news-title">News Titel</h2>
      <p class="modal-news-date" id="modal-news-date">Datum</p>
    </div>
    
    <div class="modal-body" id="modal-news-body">
      <!-- Content wird dynamisch geladen -->
    </div>
  </div>
</div>

<!-- ========== FOOTER PLACEHOLDER ========== -->
<div id="footer-placeholder">
  <!-- Footer wird automatisch vom Template Loader geladen -->
  <div class="text-center py-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Footer wird geladen...</span>
    </div>
  </div>
</div>

<script>
// Global variables
let allNews = [];

// Load news when page loads
document.addEventListener('DOMContentLoaded', function() {
  loadNews();
});

// Load news from API
async function loadNews() {
  try {
    const response = await fetch('/api/news/published');
    const data = await response.json();
    allNews = data.news || [];
    
    renderNews();
  } catch (error) {
    console.error('Fehler beim Laden der News:', error);
    showErrorMessage();
  }
}

// Render news in grid
function renderNews() {
  const newsGrid = document.getElementById('news-grid');
  
  // Clear loading spinner
  newsGrid.innerHTML = '';
  
  if (allNews.length === 0) {
    showNoNewsMessage();
    return;
  }
  
  // Render news cards
  allNews.forEach(news => {
    newsGrid.appendChild(createNewsCard(news));
  });
}

// Create news card element
function createNewsCard(news) {
  const card = document.createElement('div');
  card.className = 'news-card';
  
  // Add special classes for featured/breaking news
  if (news.isFeatured) {
    card.classList.add('featured');
  }
  if (news.isBreaking) {
    card.classList.add('breaking');
  }
  
  card.onclick = () => openNewsModal(news.id);
  
  // Map category to German
  const categoryMap = {
    'unternehmen': 'Unternehmen',
    'projekte': 'Projekte', 
    'technologie': 'Technologie',
    'team': 'Team',
    'events': 'Events'
  };
  
  // Choose icon based on category
  const iconMap = {
    'unternehmen': 'fa-building',
    'projekte': 'fa-tools',
    'technologie': 'fa-lightbulb',
    'team': 'fa-users',
    'events': 'fa-calendar-alt'
  };
  
  const icon = iconMap[news.category] || 'fa-newspaper';
  
  // Format date
  const newsDate = new Date(news.newsDate);
  const formattedDate = newsDate.toLocaleDateString('de-DE', {
    day: 'numeric',
    month: 'long', 
    year: 'numeric'
  });
  
  // Check if news has featured image or use icon
  const newsImageContent = news.featuredImage 
    ? `<img src="${news.featuredImage}" alt="${news.title}" class="news-featured-image">` 
    : `<i class="fa-solid ${icon}"></i>`;

  card.innerHTML = `
    <div class="news-image">
      ${newsImageContent}
    </div>
    <div class="news-content">
      <div class="news-date">${formattedDate}</div>
      <div class="news-category">${categoryMap[news.category] || news.category}</div>
      <h3 class="news-title">${news.title}</h3>
      <p class="news-excerpt">
        ${news.excerpt || 'Keine Beschreibung verfügbar.'}
      </p>
      <button class="news-read-more">Weiterlesen</button>
    </div>
  `;
  
  return card;
}

// Open news modal with dynamic content
function openNewsModal(newsId) {
  const news = allNews.find(n => n.id === newsId);
  if (!news) return;
  
  const modal = document.getElementById('news-modal');
  const modalTitle = document.getElementById('modal-news-title');
  const modalDate = document.getElementById('modal-news-date');
  const modalBody = document.getElementById('modal-news-body');
  
  // Set title and date
  modalTitle.textContent = news.title;
  
  const newsDate = new Date(news.newsDate);
  const formattedDate = newsDate.toLocaleDateString('de-DE', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  });
  modalDate.textContent = formattedDate;
  
  // Choose icon based on category
  const iconMap = {
    'unternehmen': 'fa-building',
    'projekte': 'fa-tools',
    'technologie': 'fa-lightbulb', 
    'team': 'fa-users',
    'events': 'fa-calendar-alt'
  };
  
  const icon = iconMap[news.category] || 'fa-newspaper';
  
  // Check if news has featured image or use icon for modal
  const modalImageContent = news.featuredImage 
    ? `<img src="${news.featuredImage}" alt="${news.title}" class="modal-featured-image">` 
    : `<i class="fa-solid ${icon}"></i>`;

  // Set body content
  modalBody.innerHTML = `
    <div class="modal-news-image">
      ${modalImageContent}
    </div>
    
    <div class="modal-news-content">
      ${news.content || '<p>Kein detaillierter Inhalt verfügbar.</p>'}
    </div>
  `;
  
  // Show modal
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

// Close news modal
function closeNewsModal() {
  const modal = document.getElementById('news-modal');
    modal.classList.remove('active');
  document.body.style.overflow = '';
}

// Show error message
function showErrorMessage() {
  const newsGrid = document.getElementById('news-grid');
  newsGrid.innerHTML = '<p class="error-message">Fehler beim Laden der News. Bitte versuchen Sie es später erneut.</p>';
}

// Show no news message
function showNoNewsMessage() {
  const newsGrid = document.getElementById('news-grid');
  newsGrid.innerHTML = '<p class="no-news-message">Derzeit keine News verfügbar.</p>';
}

// Close modal when clicking outside
document.addEventListener('click', function(e) {
  if (e.target.classList.contains('news-modal')) {
    closeNewsModal();
  }
});

// Close modal with ESC key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeNewsModal();
  }
});
</script>

  <script src="../template/assets/js/lazy-loading.js"></script>
</body>
</html> 